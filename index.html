<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paris Explorer - Découvrez tous les trésors de Paris</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#D4AF37">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Paris Explorer">
    <link rel="manifest" href="manifest.json">
    
    <!-- CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    <link rel="stylesheet" href="assets/css/themes.css">
    
    <!-- Preconnect pour optimiser le chargement -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container" id="appContainer">
        <!-- Header avec navigation -->
        <header class="header">
            <div class="header-content">
                <h1 class="app-title">🗼 Paris Explorer</h1>
                <div class="header-actions">
                    <button class="btn-header" id="settingsBtn" title="Paramètres">⚙️</button>
                    <button class="btn-header" id="helpBtn" title="Aide">❓</button>
                </div>
            </div>
        </header>

        <!-- Section Navigation -->
        <nav class="nav-section">
            <div class="user-section">
                <label for="userSelect">👤 Utilisateur :</label>
                <select id="userSelect" class="user-select">
                    <option value="">Sélectionner...</option>
                </select>
                <button class="btn btn-sm" id="addUserBtn">+ Nouveau</button>
            </div>
        </nav>

        <!-- Contrôles Recherche et Filtres -->
        <section class="controls-section">
            <div class="controls-container">
                <!-- Barre de recherche intelligente -->
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="🔍 Rechercher monuments, restaurants, cafés..." autocomplete="off">
                    <div class="search-suggestions" id="searchSuggestions"></div>
                </div>

                <!-- Filtres avancés -->
                <div class="filters-container">
                    <select id="arrondissementFilter" class="filter-select">
                        <option value="">📍 Tous les arrondissements</option>
                    </select>

                    <select id="categoryFilter" class="filter-select">
                        <option value="">🎯 Toutes les catégories</option>
                    </select>

                    <select id="statusFilter" class="filter-select">
                        <option value="">📊 Statut</option>
                        <option value="visited">✅ Visités</option>
                        <option value="not-visited">⏳ À visiter</option>
                        <option value="favorites">⭐ Favoris</option>
                    </select>

                    <div class="view-controls">
                        <button class="btn-icon" id="resetFiltersBtn" title="Réinitialiser filtres">🔄</button>
                        <button class="btn-icon" id="viewModeBtn" title="Mode d'affichage">📋</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Onglets Navigation -->
        <nav class="tabs-navigation">
            <button class="tab-btn active" data-tab="list">📋 Liste</button>
            <button class="tab-btn" data-tab="map">🗺️ Carte</button>
            <button class="tab-btn" data-tab="favorites">⭐ Favoris</button>
            <button class="tab-btn" data-tab="collections">📚 Collections</button>
            <button class="tab-btn" data-tab="achievements">🏆 Succès</button>
            <button class="tab-btn" data-tab="stats">📊 Stats</button>
        </nav>

        <!-- Contenu Principal -->
        <main class="main-content">
            <!-- Onglet Liste -->
            <div class="tab-content active" id="listTab">
                <div class="content-header">
                    <div class="progress-overview">
                        <div class="overall-stats">
                            <span class="stat-item">📍 <span id="totalPlaces">0</span> lieux</span>
                            <span class="stat-item">✅ <span id="visitedPlaces">0</span> visités</span>
                            <span class="stat-item">📊 <span id="completionRate">0%</span></span>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="dataContainer" class="data-container">
                    <!-- Le contenu sera généré par JavaScript -->
                </div>
            </div>
            
            <!-- Onglet Carte -->
            <div class="tab-content" id="mapTab">
                <div class="map-controls">
                    <div class="map-legend">
                        <span class="legend-item">✅ <span style="color: #059669;">Visité</span></span>
                        <span class="legend-item">📍 <span style="color: #D4AF37;">À explorer</span></span>
                    </div>
                </div>
                <div id="mapContainer" class="map-container">
                    <!-- La carte Leaflet sera initialisée ici -->
                </div>
            </div>
            
            <!-- Onglet Favoris -->
            <div class="tab-content" id="favoritesTab">
                <div class="content-header">
                    <h2>⭐ Mes Favoris</h2>
                    <div class="content-actions">
                        <button class="btn btn-primary" id="exportFavoritesBtn">📤 Exporter</button>
                        <button class="btn btn-secondary" id="clearFavoritesBtn">🗑️ Vider</button>
                    </div>
                </div>
                <div id="favoritesContainer" class="favorites-container">
                    <!-- Les favoris seront générés par JavaScript -->
                </div>
            </div>
            
            <!-- Onglet Collections -->
            <div class="tab-content" id="collectionsTab">
                <div class="content-header">
                    <h2>📚 Mes Collections</h2>
                    <div class="content-actions">
                        <button class="btn btn-primary" id="createCollectionBtn">+ Nouvelle Collection</button>
                        <button class="btn btn-secondary" id="importCollectionBtn">📥 Importer</button>
                    </div>
                </div>
                <div id="collectionsContainer" class="collections-container">
                    <!-- Les collections seront générées par JavaScript -->
                </div>
            </div>
            
            <!-- Onglet Achievements -->
            <div class="tab-content" id="achievementsTab">
                <div class="content-header">
                    <h2>🏆 Succès & Récompenses</h2>
                    <div class="achievement-stats">
                        <span id="achievementProgress">0 / 42 succès débloqués</span>
                    </div>
                </div>
                <div id="achievementsContainer" class="achievements-container">
                    <!-- Les achievements seront générés par JavaScript -->
                </div>
            </div>
            
            <!-- Onglet Statistiques -->
            <div class="tab-content" id="statsTab">
                <div class="content-header">
                    <h2>📊 Statistiques Détaillées</h2>
                </div>
                <div id="statsContainer" class="stats-container">
                    <!-- Les statistiques seront générées par JavaScript -->
                </div>
            </div>
        </main>
    </div>
    
    <!-- Modals -->
    
    <!-- Modal Ajout Utilisateur -->
    <div class="modal" id="userModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">👤 Nouvel Utilisateur</h3>
                <button class="close-btn" id="closeUserModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="userForm">
                    <div class="form-group">
                        <label for="userName">Nom :</label>
                        <input type="text" id="userName" required maxlength="30" placeholder="Entrez le nom">
                    </div>
                    <div class="form-group">
                        <label for="userColor">Couleur :</label>
                        <select id="userColor">
                            <option value="#D4AF37">🟡 Or</option>
                            <option value="#059669">🟢 Vert</option>
                            <option value="#DC2626">🔴 Rouge</option>
                            <option value="#7C3AED">🟣 Violet</option>
                            <option value="#EA580C">🟠 Orange</option>
                            <option value="#0891B2">🔵 Bleu</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="saveUserBtn">Créer</button>
                <button class="btn btn-secondary" id="cancelUserBtn">Annuler</button>
            </div>
        </div>
    </div>
    
    <!-- Modal Paramètres -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">⚙️ Paramètres</h3>
                <button class="close-btn" id="closeSettingsBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h4>Affichage</h4>
                    <div class="setting-item">
                        <label for="themeSelect">Thème :</label>
                        <select id="themeSelect">
                            <option value="default">🌟 Parisien (défaut)</option>
                            <option value="dark">🌙 Sombre</option>
                            <option value="light">☀️ Clair</option>
                        </select>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h4>Données</h4>
                    <div class="setting-actions">
                        <button class="btn btn-primary" id="exportAllBtn">📤 Exporter toutes les données</button>
                        <button class="btn btn-secondary" id="importDataBtn">📥 Importer des données</button>
                        <button class="btn btn-danger" id="clearAllDataBtn">🗑️ Effacer toutes les données</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Collection -->
    <div class="modal" id="collectionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="collectionModalTitle">📚 Nouvelle Collection</h3>
                <button class="close-btn" id="closeCollectionModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="collectionForm">
                    <div class="form-group">
                        <label for="collectionName">Nom de la collection :</label>
                        <input type="text" id="collectionName" required placeholder="Mes restaurants favoris...">
                    </div>
                    <div class="form-group">
                        <label for="collectionDescription">Description :</label>
                        <textarea id="collectionDescription" placeholder="Description optionnelle..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="collectionColor">Couleur :</label>
                        <select id="collectionColor">
                            <option value="#D4AF37">🟡 Or</option>
                            <option value="#059669">🟢 Vert</option>
                            <option value="#DC2626">🔴 Rouge</option>
                            <option value="#7C3AED">🟣 Violet</option>
                            <option value="#EA580C">🟠 Orange</option>
                            <option value="#0891B2">🔵 Bleu</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="saveCollectionBtn">Sauvegarder</button>
                <button class="btn btn-secondary" id="cancelCollectionBtn">Annuler</button>
            </div>
        </div>
    </div>
    
    <!-- Modal Notes -->
    <div class="modal" id="noteModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="noteModalTitle">📝 Notes</h3>
                <button class="close-btn" id="closeNoteModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="note-form">
                    <textarea id="noteTextarea" placeholder="Ajoutez vos notes, impressions, conseils..."></textarea>
                    <div class="form-actions">
                        <button class="btn btn-primary" id="saveNoteBtn">Sauvegarder</button>
                        <button class="btn btn-secondary" id="cancelNoteBtn">Annuler</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Details Lieu -->
    <div class="modal" id="placeModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 class="modal-title" id="placeModalTitle"></h3>
                <button class="close-btn" id="closePlaceModalBtn">&times;</button>
            </div>
            <div class="modal-body" id="placeModalContent">
                <!-- Contenu détaillé du lieu -->
            </div>
        </div>
    </div>
    
    <!-- Toast Notifications Container -->
    <div class="notifications-container" id="notificationsContainer">
        <!-- Les notifications dynamiques apparaîtront ici -->
    </div>
    
    <!-- Inputs cachés -->
    <input type="file" id="importFileInput" accept=".json" style="display: none;">
    
    <!-- Loading Spinner Global -->
    <div class="global-loading" id="globalLoading" style="display: none;">
        <div class="loading-spinner"></div>
        <p>Chargement...</p>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Modules JavaScript -->
    <script src="assets/js/utils.js"></script>
    <script src="assets/js/data-manager.js"></script>
    <script src="assets/js/user-manager.js"></script>
    <script src="assets/js/map-manager.js"></script>
    <script src="assets/js/ui-manager.js"></script>
    <script src="assets/js/search-filter.js"></script>
    <script src="assets/js/export-import.js"></script>
    <script src="assets/js/app.js"></script>
    
    <!-- Service Worker pour PWA -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(registrationError => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>
